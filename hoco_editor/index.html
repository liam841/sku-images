<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoco Parts Excel Editor</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">ğŸ“Š Hoco Parts Excel Editor</h1>
            <p class="subtitle">Transform your Excel files with automated processing</p>
        </header>

        <!-- File Upload Section -->
        <section class="card">
            <h2 class="section-title">ğŸ“ Select Excel Files</h2>
            <div class="upload-area" id="uploadArea">
                <div class="upload-content">
                    <div class="upload-icon">ğŸ“¤</div>
                    <p class="upload-text">Drop your .xlsx files here or click to browse</p>
                    <button class="upload-button" onclick="document.getElementById('fileInput').click()">
                        Choose Files
                    </button>
                </div>
                <input type="file" id="fileInput" multiple accept=".xlsx" style="display: none;">
            </div>
            
            <!-- File List -->
            <div class="file-list" id="fileList" style="display: none;">
                <h3>Selected Files:</h3>
                <ul id="fileListItems"></ul>
                <button class="secondary-button" onclick="clearFiles()">Clear All</button>
            </div>
        </section>

        <!-- Processing Section -->
        <section class="card">
            <h2 class="section-title">âš™ï¸ Processing</h2>
            
            <!-- Progress Bar -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Processing files...</p>
            </div>

            <!-- Process Button -->
            <button class="primary-button" id="processButton" onclick="processFiles()" disabled>
                ğŸš€ Process Files
            </button>

            <!-- Results -->
            <div class="results" id="results" style="display: none;">
                <h3>âœ… Processing Complete!</h3>
                <p id="resultsText"></p>
                <div class="download-section" id="downloadSection"></div>
            </div>
        </section>

        <!-- Instructions -->
        <section class="card">
            <h2 class="section-title">ğŸ“‹ Instructions</h2>
            <div class="instructions">
                <div class="instruction-item">
                    <span class="instruction-number">1</span>
                    <span>Select one or more .xlsx files to process</span>
                </div>
                <div class="instruction-item">
                    <span class="instruction-number">2</span>
                    <span>Click "Process Files" to apply transformations</span>
                </div>
                <div class="instruction-item">
                    <span class="instruction-number">3</span>
                    <span>Download your processed CSV files</span>
                </div>
            </div>
            
            <div class="transformations">
                <h3>Transformations Applied:</h3>
                <ul>
                    <li>ğŸ—‘ï¸ Delete columns A & C</li>
                    <li>ğŸ·ï¸ Rename new column A to 'SKU'</li>
                    <li>ğŸ“Š Rename new column B to 'Stock Level'</li>
                    <li>ğŸ“ Add new column 'Location' filled with 'Hoco Parts'</li>
                    <li>ğŸ”¢ Remove commas from stock level numbers (1,000 â†’ 1000)</li>
                    <li>ğŸ’¾ Export as CSV format</li>
                </ul>
            </div>
        </section>
    </div>

    <script src="script.js"></script>
</body>
</html>
